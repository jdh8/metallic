/* Error function restricted to [-0.84375, 0.84375] */
static double near0_(double x)
{
    const double c[] = {
        1.2837916709551257358e-01,
       -3.7612638903183740346e-01,
        1.1283791670954367814e-01,
       -2.6866170644945538905e-02,
        5.2239776230901943479e-03,
       -8.5483268475636548560e-04,
        1.2055324632852127628e-04,
       -1.4925388936963054191e-05,
        1.6456634784970233105e-06,
       -1.6289507107602459607e-07,
        1.4124231832943601482e-08,
       -8.6697290255536863161e-10
    };

    double x2 = x * x;
    double x4 = x2 * x2;
    double x8 = x4 * x4;

    return x + x * (c[0] + c[1] * x2 + (c[2] + c[3] * x2) * x4
        + (c[4] + c[5] * x2 + (c[6] + c[7] * x2) * x4) * x8
        + (c[8] + c[9] * x2 + (c[10] + c[11] * x2) * x4) * (x8 * x8));
}

/* Error function restricted to [0.84375, 1.25] */
static double near1_(double x)
{
    const double c[] = {
       -2.4856130825934362894e-17,
        4.1510749742059521750e-01,
       -4.1510749742059487983e-01,
        1.3836916580649731812e-01,
        6.9184582904022372690e-02,
       -6.9184582829279800335e-02,
        4.6123053226003033062e-03,
        1.5154712039503498119e-02,
       -4.7770070199119698622e-03,
       -1.8849734210792739716e-03,
        1.2251733972180058535e-03,
        8.3315834868728835768e-05,
       -1.8120800992681500844e-04
    };

    double y = x - 1;
    double y2 = y * y;
    double y4 = y2 * y2;

    return c[0] + c[1] * y + (c[2] + c[3] * y) * y2
        + (c[4] + c[5] * y + (c[6] + c[7] * y) * y2) * y4
        + (c[8] + c[9] * y + (c[10] + c[11] * y) * y2 + c[12] * y4) * (y4 * y4)
        + 0x1.af767a741088bp-1;
}

static double kernel_(double x)
{
    if (x < 0.84375)
        return near0_(x);

    if (x < 1.25)
        return near1_(x);
}
